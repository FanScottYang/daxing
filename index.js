const createCsvWriter = require('csv-writer').createArrayCsvWriter;
const yaml = require('js-yaml');
const path = require('path');
const fs   = require('fs');
const csvWriter = createCsvWriter({
    path: path.join(path.dirname(process.execPath), '/result.csv')
});
console.log('start...........')

const matrix = [
    ['N6', 'N7', 'N10', 'N11', 'N15', 'N16', 'N17'],
    ['N4', 'N8', 'N9', 'N10', 'N14', 'N15', 'N17'],
    ['N1', 'N3', 'N4', 'N7', 'N9', 'N10', 'N15'],
    ['N2', 'N7', 'N10', 'N12', 'N13', 'N14', 'N15'],
    ['N4', 'N5', 'N6', 'N9', 'N10', 'N11', 'N15'],
    ['N1', 'N2', 'N8', 'N10', 'N11', 'N15', 'N16'],
    ['N2', 'N3', 'N5', 'N6', 'N10', 'N12', 'N15'],
    ['N2', 'N4', 'N5', 'N9', 'N10', 'N13', 'N17'],
    ['N1', 'N5', 'N6', 'N10', 'N13', 'N16', 'N17'],
    ['N1', 'N3', 'N4', 'N5', 'N8', 'N10', 'N17'],
    ['N1', 'N3', 'N10', 'N11', 'N12', 'N13', 'N17'],
    ['N1', 'N2', 'N6', 'N10', 'N12', 'N14', 'N17'],
    ['N5', 'N7', 'N9', 'N10', 'N12', 'N14', 'N16'],
    ['N5', 'N7', 'N8', 'N10', 'N11', 'N12', 'N16'],
    ['N1', 'N4', 'N5', 'N7', 'N10', 'N11', 'N14'],
    ['N2', 'N3', 'N4', 'N6', 'N7', 'N8', 'N10'],
    ['N1', 'N3', 'N9', 'N10', 'N12', 'N14', 'N16'],
    ['N1', 'N5', 'N6', 'N8', 'N9', 'N10', 'N13'],
    ['N3', 'N6', 'N9', 'N10', 'N11', 'N13', 'N14'],
    ['N4', 'N8', 'N10', 'N11', 'N12', 'N13', 'N16'],
    ['N1', 'N2', 'N3', 'N4', 'N10', 'N12', 'N16'],
    ['N2', 'N3', 'N6', 'N10', 'N11', 'N13', 'N16'],
    ['N2', 'N3', 'N5', 'N6', 'N8', 'N10', 'N14'],
    ['N2', 'N3', 'N6', 'N7', 'N9', 'N15', 'N17'],
    ['N2', 'N4', 'N5', 'N7', 'N15', 'N16', 'N17'],
    ['N3', 'N9', 'N12', 'N13', 'N15', 'N16', 'N17'],
    ['N1', 'N4', 'N5', 'N8', 'N12', 'N15', 'N17'],
    ['N3', 'N5', 'N8', 'N13', 'N14', 'N15', 'N17'],
    ['N3', 'N5', 'N7', 'N8', 'N9', 'N13', 'N15'],
    ['N1', 'N2', 'N6', 'N7', 'N9', 'N14', 'N15'],
    ['N3', 'N7', 'N8', 'N11', 'N12', 'N14', 'N15'],
    ['N1', 'N6', 'N7', 'N8', 'N12', 'N13', 'N15'],
    ['N2', 'N4', 'N5', 'N9', 'N11', 'N12', 'N15'],
    ['N4', 'N5', 'N6', 'N13', 'N14', 'N15', 'N16'],
    ['N1', 'N2', 'N5', 'N11', 'N14', 'N15', 'N16'],
    ['N1', 'N3', 'N4', 'N6', 'N8', 'N11', 'N15'],
    ['N2', 'N4', 'N6', 'N8', 'N11', 'N13', 'N15'],
    ['N1', 'N2', 'N5', 'N7', 'N9', 'N11', 'N17'],
    ['N2', 'N7', 'N8', 'N9', 'N11', 'N12', 'N17'],
    ['N1', 'N7', 'N8', 'N13', 'N14', 'N16', 'N17'],
    ['N3', 'N4', 'N6', 'N7', 'N12', 'N13', 'N17'],
    ['N5', 'N6', 'N7', 'N11', 'N12', 'N14', 'N17'],
    ['N3', 'N5', 'N6', 'N8', 'N9', 'N16', 'N17'],
    ['N1', 'N4', 'N9', 'N11', 'N13', 'N14', 'N17'],
    ['N2', 'N3', 'N4', 'N11', 'N14', 'N16', 'N17'],
    ['N4', 'N7', 'N8', 'N9', 'N11', 'N13', 'N16'],
    ['N1', 'N2', 'N3', 'N7', 'N9', 'N12', 'N13'],
    ['N1', 'N3', 'N4', 'N6', 'N7', 'N14', 'N16'],
    ['N1', 'N2', 'N3', 'N5', 'N7', 'N13', 'N16'],
    ['N1', 'N2', 'N4', 'N5', 'N6', 'N7', 'N8'],
    ['N1', 'N4', 'N6', 'N9', 'N11', 'N12', 'N16'],
    ['N2', 'N6', 'N8', 'N9', 'N12', 'N14', 'N16'],
    ['N1', 'N3', 'N4', 'N5', 'N9', 'N12', 'N14'],
    ['N1', 'N2', 'N3', 'N4', 'N8', 'N9', 'N13'],
    ['N2', 'N5', 'N8', 'N11', 'N12', 'N13', 'N14']
]

try {
    let fileContents = fs.readFileSync(path.join(path.dirname(process.execPath), '/config.yml'), 'utf8');
    let map = yaml.safeLoad(fileContents);

    const records = matrix.map(row => row.map(n => map[n]) )

    csvWriter.writeRecords(records)       // returns a promise
        .then(() => {
            console.log('...Done');
        });
} catch (e) {
    console.log(e);
}

